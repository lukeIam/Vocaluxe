language: csharp
solution: Vocaluxe.sln
env:
  matrix:
  - config=Linux platform=x64
  - config=Linux platform=x86
branches:
  except:
  - Nightly
before_install:
  - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
  - sudo apt-get update -qq
  - sudo apt-get install -y gcc-4.8 g++-4.8
  - sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.8 20
  - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.8 20
  - sudo update-alternatives --config gcc
  - sudo update-alternatives --config g++
  - chmod ugo+x ./.build/linuxPostBuildEvent.sh
  - chmod ugo+x ./.build/linuxPreBuildEvent.sh
  - chmod ugo+x ./.travis/gitDescribe.sh
  - chmod ugo+x ./.travis/installFFmpeg.sh
  - sudo ./.travis/installFFmpeg.sh
script:
- ./.travis/gitDescribe.sh
- make -C PitchTracker
- make -C Vocaluxe/Lib/Video/Acinerella
- xbuild /p:Configuration=Release$config /p:Platform=$platform Vocaluxe.sln
before_deploy:
- chmod ugo+x ./.travis/packArtifact.sh
- "./.travis/packArtifact.sh"
#- chmod ugo+x ./.travis/moveTagForSpecialBranches.sh
#- "./.travis/moveTagForSpecialBranches.sh"
deploy:
  provider: releases
  api_key: $GITHUB_KEY
  file: build/Vocaluxe_$GIT_TAG_$config_$platform.zip
  skip_cleanup: true
  on:
    repo: lukeIam/Vocaluxe
    tags: true
